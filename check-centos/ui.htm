<div>
<style>
	div.landscape { 
		width: 120px; 
		float: left; 
		border-right-style: solid; 
		background-color: #4b758b;
		border-right-width: 3px;
		border-right-color: white; 
		margin-top: 5px; 
		padding-left: 5px;
		padding-bottom: 3px;
		font-weight: bold;
		color: white;	
	}

	.hide { display: none; }

	td { font-family:monospace; }
</style>
<script>

	function validate_checkboxes(chk) {
		var ours = document.getElementById('ours').innerText;
		var theirs = document.getElementById('theirs').innerText;
		if(/^\w+$/.test(ours) && /^\w+$/.test(theirs)) {
			if(ours != theirs) {
				toggle_checkboxes(chk);
				return;
			}
		}
		if(confirm('Our centos image id appears to be up-to-date with dockerhub.\n\nContinue anyway?')) {
			toggle_checkboxes(chk);
		}
		else {
			document.getElementById('build-action').value = '0';
		}		
	}

	function toggle_checkboxes(chk) {
		switch(chk.id) {
			case 'landscape-all':
				toggle(['centos', 'apache', 'kuali', 
					'landscape-sb', 'landscape-ci', 'landscape-qa', 'landscape-stg', 'landscape-prod',
					'centos-sb', 'centos-ci', 'centos-qa', 'centos-stg', 'centos-prod',
					'apache-sb', 'apache-ci', 'apache-qa', 'apache-stg', 'apache-prod',
					'kuali-sb', 'kuali-ci', 'kuali-qa', 'kuali-stg', 'kuali-prod'], chk.checked);
				break;
			case 'landscape-sb': case 'landscape-ci': case 'landscape-qa': case 'landscape-stg': case 'landscape-prod':
				var landscape = chk.id.split('\-')[1];
				if(chk.checked) {
					toggle(['centos', 'apache', 'kuali', 
						'centos-'+landscape, 'apache-'+landscape, 'kuali-'+landscape], chk.checked);
				}
				else {
					toggle(['landscape-all', 'centos-'+landscape, 'apache-'+landscape, 'kuali-'+landscape], chk.checked);
					if(noLandscapes()) {
						toggle(['centos', 'apache', 'kuali'], chk.checked);
					}
				}
				break;
			case 'centos': case 'apache': case 'kuali':
				if(chk.checked) {
					toggleRow(chk.id, ['sb', 'ci', 'qa', 'stg', 'prod'], true);
				}
				else {
					toggle(['landscape-all', 'landscape-sb', 'landscape-ci', 'landscape-qa', 'landscape-stg', 'landscape-prod',
						chk.id+'-sb', chk.id+'-ci', chk.id+'-qa', chk.id+'-stg', chk.id+'-prod'], chk.checked);
				}
				break;
			default:
				if(!chk.checked) {
					var image = chk.id.split('\-')[0];
					var landscape = chk.id.split('\-')[1];
					toggle(['landscape-all', 'landscape-'+landscape], chk.checked);
					if(noImages(image)) {
						toggle([image, image+'-sb', image+'-ci', image+'-qa', image+'-stg', image+'-prod'], chk.checked);
					}
				}
		}

		var counter=0;
		if(allChecked('sb')) { 
			toggle(['landscape-sb'], true); 
			counter++;
		}
		if(allChecked('ci')) {
			toggle(['landscape-ci'], true);
			counter++;
		}
		if(allChecked('qa')) {
			toggle(['landscape-qa'], true);
			counter++;
		}
		if(allChecked('stg')) {
			toggle(['landscape-stg'], true);
			counter++;
		}
		if(allChecked('prod')) {
			toggle(['landscape-prod'], true);
			counter++;
		}
		if(counter == 5) {
			toggle(['centos', 'apache', 'kuali', 'landscape-all'], true);
		}

		serializeChoices();
	}

	function toggle(chkIds, show) {
		for(var i=0; i<chkIds.length; i++) {
			var chk = document.getElementById(chkIds[i]);
			if(chk != null) {
				chk.checked = show;
				if(/\-/.test(chk.id) && /landscape/.test(chk.id) == false) {
					chk.parentElement.parentElement.parentElement.className = show ? '' : 'hide';
				}
			}
		}
	}

	function toggleRow(image, landscapes, show) {
		for(var i=0; i<landscapes.length; i++) {
			var chk = document.getElementById(image+'-'+landscapes[i]);
			if(chk != null) {
				chk.parentElement.parentElement.parentElement.className = show ? '' : 'hide';
			}
		}

	}

	function sameCheckedStatus(chkIds, show) {
		for(var i=0; i<chkIds.length; i++) {
			var chk = document.getElementById(chkIds[i]);
			if(chk != null && chk.checked != show) {
				return false;
			}
		}
		return true;
	}

	function noLandscapes() {
		return sameCheckedStatus(['landscape-sb', 'landscape-ci', 'landscape-qa', 'landscape-stg', 'landscape-prod'], false);
	}

	function noImages(image) {
		return sameCheckedStatus([image+'-sb', image+'-ci', image+'-qa', image+'-stg', image+'-prod'], false);
	}

	function allChecked(landscape) {
		if(landscape == null || landscape == undefined) {
			return sameCheckedStatus(['centos-sb', 'centos-ci', 'centos-qa', 'centos-stg', 'centos-prod',
						'apache-sb', 'apache-ci', 'apache-qa', 'apache-stg', 'apache-prod',
						'kuali-sb', 'kuali-ci', 'kuali-qa', 'kuali-stg', 'kuali-prod'], true);
		}
		return sameCheckedStatus(['centos-'+landscape, 'apache-'+landscape, 'kuali-'+landscape], true);
	}

	function serializeChoices() {
		var choices = ['centos-sb', 'centos-ci', 'centos-qa', 'centos-stg', 'centos-prod',
				'apache-sb', 'apache-ci', 'apache-qa', 'apache-stg', 'apache-prod',
				'kuali-sb', 'kuali-ci', 'kuali-qa', 'kuali-stg', 'kuali-prod'];
		var s = '';
		for(var i=0; i<choices.length; i++) {
			if(document.getElementById(choices[i]).checked) {
				s += ((s?', ':'') + choices[i]);
			}
		}
		document.getElementById('build-action').value = s;
	}
</script>

<table border=0 style='font-family:arial; font-size:10px'>
<tr>
	<td align=right>local centos:7 image id:</td>
	<td id='ours' style='font-family:monospace; padding-left:8px;'>97ca462ad9eeae25941546209454496e1d66749d53dfa2ee32bf1faabd239d38</td>
</tr>
<tr>
	<td align=right>dockerhub centos:7 image id:</td>
	<td id='theirs' style='font-family:monospace; padding-left:8px;'>5a2725191d75eb64e9b7c969cd23d8c67c6e8af9979e521a417bbfa34434fb83</td>
</tr>
<tr>
	<td colspan=2><hr width='100%'></td>
</tr>
<tr>
	<td colspan=2>By Landscape:<br>
		<div class='landscape' style='margin-bottom:10px;'>All:<input type='checkbox' id='landscape-all' onclick="validate_checkboxes(this)"></div>
		<div class='landscape'>sandbox:<input type='checkbox' id='landscape-sb' onclick="validate_checkboxes(this)"></div>
		<div class='landscape'>ci:<input type='checkbox' id='landscape-ci' onclick="validate_checkboxes(this)"></div>
		<div class='landscape'>qa:<input type='checkbox' id='landscape-qa' onclick="validate_checkboxes(this)"></div>
		<div class='landscape'>staging:<input type='checkbox' id='landscape-stg' onclick="validate_checkboxes(this)"></div>
		<div class='landscape'>production:<input type='checkbox' id='landscape-prod' onclick="validate_checkboxes(this)"></div>
	</td>
</tr>
<tr>
	<td>Rebuild centos/java/tomcat docker image:</td>
	<td style='font-family:monospace; padding-left:8px;'><input id='centos' type=checkbox onclick="validate_checkboxes(this)"></td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='centos-sb' type=checkbox onclick="validate_checkboxes(this)">sandbox</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='centos-ci' type=checkbox onclick="validate_checkboxes(this)">ci</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='centos-qa' type=checkbox onclick="validate_checkboxes(this)">qa</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='centos-stg' type=checkbox onclick="validate_checkboxes(this)">staging</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='centos-prod' type=checkbox onclick="validate_checkboxes(this)">production</div>
	</td>
</tr>
<tr><td colspan=2>&nbsp; </td></tr>
<tr>
	<td>Rebuild apache/shibboleth image:</td>
	<td style='font-family:monospace; padding-left:8px;'><input id='apache' type=checkbox onclick="validate_checkboxes(this)"></td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='apache-sb' type=checkbox onclick="validate_checkboxes(this)">sandbox</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='apache-ci' type=checkbox onclick="validate_checkboxes(this)">ci</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='apache-qa' type=checkbox onclick="validate_checkboxes(this)">qa</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='apache-stg' type=checkbox onclick="validate_checkboxes(this)">staging</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='apache-prod' type=checkbox onclick="validate_checkboxes(this)">production</div>
	</td>
</tr>
<tr><td colspan=2>&nbsp; </td></tr>
<tr>
	<td>Rebuild kuali-research image:</td>
	<td style='font-family:monospace; padding-left:8px;'><input id='kuali' type=checkbox onclick="validate_checkboxes(this)"></td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='kuali-sb' type=checkbox onclick="validate_checkboxes(this)">sandbox</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='kuali-ci' type=checkbox onclick="validate_checkboxes(this)">ci</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='kuali-qa' type=checkbox onclick="validate_checkboxes(this)">qa</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='kuali-stg' type=checkbox onclick="validate_checkboxes(this)">staging</div>
	</td>
</tr>
<tr class=hide>
	<td colspan=2 style='font-family:monospace; padding-left:50px;'>
		<div><input id='kuali-prod' type=checkbox onclick="validate_checkboxes(this)">production</div>
	</td>
</tr>
<tr>
	<td colspan=2><input type=hidden id='build-action' name='value' style='width:700px;'> </td>
</tr>


</table>
</div>